Code taken from Powerlifted but see files for the original source.
